# Как использовать Async / Await в JavaScript? #
![alt-текст](https://github.com/YaroslavW/trening-js/blob/master/Texts/Async-Await/img/async-await.jpg "Текст заголовка логотипа 1")
Асинхронный код, часто трудно представить нашему разуму.  Новое дополнение к ES8, которое существует уже некоторое время, - это функции `async / await`. До внедрения `async / await` мы использовали обратные вызовы и обещания.<br/>

Если вы новичок в JavaScript, вы можете узнать, что такое обещания, и сразу перейти к async / await. Если вы все еще используете обещания, настало время изучить async / await.<br/>

## Недостаток старых методов ##
Чтобы понять, почему функции async / await предпочтительнее, чем `Promises`, нам нужно понять, какие проблемы возникают с использованием `Promises`.<br/>

### Callback Hell ###
Представьте, что в вашем коде много обратных вызовов, вложенных в серию вызовов функций. Весьма часто можно увидеть код с множеством вложенных обратных вызовов, который называется адом обратного вызова - `Callback Hell`. Вам становится трудно читать, поддерживать и тестировать код на этом этапе. На мой взгляд, код, который нелегко читать, не является хорошим кодом. Это то, с чем может помочь `async / await`.<br/>

### Обработка ошибок ###
И обратные вызовы, и обещания не предлагают чистого способа обработки ошибок. Вам будет трудно узнать, какой из  Promise выдает ошибку, если вы находитесь в куче вложенных обещаний. Async / await подсветит это и в обработке ошибок.<br/>

## Почему были введены функции async / await? ##
Чтобы смягчить некоторые болевые точки, возникающие при написании асинхронного кода с использованием `Promises` или обратных вызовов, был введен `async / await`. Они позволяют писать асинхронный код синхронно. Это позволяет вам писать асинхронный код, который позволит избежать какого-либо обратного вызова, а также гарантирует, что код является чистым и поддерживаемым. Следовательно, введение `async / await`, которое легче читать и поддерживать.<br/>

### `Async` - Асинхронный ###
Функции с ключевым словом **«async»** указывают, что функция всегда возвращает `Promise`. Если функция выдает ошибку, то Обещание (`Promise`) будет отклонено. Если функция возвращает значение, обещание (`Promise`) будет выполнено. Достаточно просто!<br/>

```javascript
  async function add(a,b) {
  return a+b;
  }
```
### `Await` - Ожидание ###
`Await` - ключевое слово работает только в  _асинхронных_  функциях. `await`  заставляет JavaScript ждать, пока обещание не будет выполнено.<br/>
>Имейте в виду, что вы не можете использовать  **await**  в обычных функциях. Работает **только внутри  асинхронных  функций**.<br/>
>
Давайте посмотрим на некоторые фрагменты кода. Мы можем использовать несколько  операторов `await`.<br/>

```javascript
  async function ToDoOne() { ... }
  async function ToDoTwo(value) { ... }
  async function ToDoThree(value) { ... }
  async function ToDos() {
    let resultOne = await ToDoOne();
    let resultTwo = await ToDoTwo(resultOne);
    let finalResult = await ToDoThree(resultTwo);
    return finalResult;
  }
  // Call ToDos()
  ToDos();
```
Мы можем использовать несколько  операторов ожидания - `await` . _ToDoThree ()_ будет ожидать завершения  _ToDoTwo ()_. И _ToDoTwo ()_  будет ожидать завершения  _ToDoOne ()_. <br/>

Если вы наблюдаете фрагмент кода выше, он выглядит очень близко к синхронному коду. Это главное преимущество использования функций `async / await`. Они делают асинхронный код похожим на синхронный код, что облегчает его чтение и обслуживание. В  `Await`  ключевых слов гарантирует , что JavaScript ждет , пока каждая  _асинхронная_  функция возвращает результат.<br/>

### `async/await` c `Promise.all` ###
Если вам нужно дождаться нескольких обещаний, вы можете заключить их в  `Promise.all` и ждать - `await`. Вместо использования нескольких  операторов `await`,  как в предыдущем примере, если вы хотите, чтобы ваши обещания выполнялись одновременно, вы можете использовать  `Promise.all ()` в вашей  _асинхронной_  функции.

```javascript
  // wait for the array of results
  let results = await Promise.all([
    fetch(url1),
    fetch(url2),
    ...
  ]);
```
### Обработка ошибок с использованием `try & catch` ###
В `async/await` обработка ошибок - `еrrors` может быть представлена в гораздо более простом способе, с помощью `try/catch` блоков так же , как и любого другого _синхронного_ кода. Любой код, который мы хотим запустить после выполнения обещания, мы можем использовать  `finally`.

```javascript
  let isOurPromiseFinished = false;
  const myAsyncAwaitBlock = async (str) => {
    try {
      // Promise is resolved
      const myPromise = await returnsAPromise(str);
      console.log(`using async/await, ${res}`);
    } catch(error) {
      // Promise is rejected
      console.log(error);
    } finally {
      isOurPromiseFinished = true;
    }
  }
  myAsyncAwaitBlock(myFirstString);
```

## Преимущества `Async / Await` ##
1. **Чистый код** -  из всех подходов, доступных нам сегодня, `async / await` приводит к самому чистому и наиболее обслуживаемому коду.<br/>
2. **Лучшая обработка ошибок** -  ошибки могут обрабатываться намного проще, используя блоки `try / catch`, как и любой другой синхронный код.<br/>
3. **Простая отладка** -  установка точек останова с помощью  ожидающих  вызовов возможна и проще в отладке по сравнению с обещаниями и обратными вызовами.<br/>
<br/>
## Повторный Async/Await ##
* _Асинхронные_  функции возвращают обещание.
* `await`  ключевое слово , которое заставляет JavaScript ждать , пока это обещание не будет выполнено.
* `await` нельзя использовать вне _асинхронной_ функции.
* В одной асинхронной функции может быть несколько операторов ожидания.
* `async / await` делает ваш асинхронный код написанным синхронно, что делает его читаемым.
* Код читабелен, удобен в обслуживании и подходит для обработки ошибок.

### Заключение ###
**Async / await** - одна из лучших функций, добавленных в JavaScript. Если у вас есть тонны кода с **Promises**, я рекомендую вам реорганизовать вашу кодовую базу, чтобы вместо нее использовать  `async / await`  . Вы будете удивлены, увидев, насколько более читабельным и чистым будет ваш код после переписывания.<br/>

Автор статьи [Christopher Cooper](https://morioh.com/p/34f72ba9fd06/how-to-use-async-await-in-javascript) Оригинал статьи доступен по ссылке.<br/> Автор перевода [Yaroslav Kolesnikov](https://github.com/YaroslavW)
